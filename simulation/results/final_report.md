# Phase 0 シミュレーション 最終パラメータ推奨レポート

**作成日：** 2026-02-15
**Stage 3 完了：** DoE L16 × 16実験、Grace Period スキャン（3条件）、T010（Scenario G）実施済み

---

## 1. 推奨パラメータ（結論）

| パラメータ | 推奨値 | 根拠 |
|---|---|---|
| κ（減価加速係数） | **0.5** | DoE L16 最適解 Run #0 |
| θ（異常閾値） | **0.35** | DoE L16 最適解、FPR 最小化 |
| β（softmin スケール） | **0.5** | DoE L16 最適解 |
| Bloom 間隔 | **7日** | DoE L16 最適解 |
| Grace Period | **14日** | Grace Period スキャン（14/30/60 で差なし→最短を採用）|
| D軸（距離軸） | **不使用（Phase 0）** | T010 で有効性に一貫性なし |

---

## 2. DoE L16 実験結果

### 2.1 実験設計

| 因子 | 低水準 | 高水準 |
|---|---|---|
| κ | 0.5 | 2.5 |
| θ | 0.35 | 0.60 |
| β | 0.5 | 2.0 |
| Bloom間隔 | 7日 | 14日 |

16実験 × 2シナリオ（A: Simple Sybil k=10, C: Loop k=5）= 32ケース

### 2.2 スコアランキング（上位5件）

| 順位 | Run | κ | θ | β | Bloom | スコア | ROI(A10) | FPR(A10) | TPR(A10) | ROI(C5) |
|---|---|---|---|---|---|---|---|---|---|---|
| 1 | #0 | 0.5 | 0.35 | 0.5 | 7d | **22.28** | 0.679 | 28.1% | 30.0% | 70.9 |
| 2 | #7 | 2.5 | 0.60 | 2.0 | 7d | 26.58 | 0.608 | 100% | 100% | 68.2 |
| 3 | #6 | 0.5 | 0.60 | 2.0 | 7d | 26.83 | 0.666 | 99.5% | 100% | 71.2 |
| 4 | #8 | 0.5 | 0.35 | 0.5 | 14d | 26.85 | 0.564 | 88.6% | 80.0% | 71.5 |
| 5 | #9 | 2.5 | 0.35 | 0.5 | 14d | 26.96 | 0.659 | 87.6% | 80.0% | 72.7 |

### 2.3 主効果の傾向

```
κ の影響:    低い(0.5) の方がスコア改善傾向
             → κ を下げると FPR を抑えつつ ROI も維持

θ の影響:    低い(0.35) の方がスコア改善傾向
             → θ を上げすぎると FPR が急増（θ=0.60 では FPR=99〜100%）

β の影響:    低い(0.5) の方がスコア改善傾向
             → β=0.5 で softmin が穏やか、高β は差を強調しすぎる

Bloom間隔:   7日の方がわずかに良好
             → 頻繁な Bloom で公平性が維持される
```

---

## 3. Grace Period スキャン結果

**シナリオ F（復帰ユーザー、攻撃者なし）での測定**

| Grace Period | ROI | FPR | コミュニティ安定性 | 推奨 |
|---|---|---|---|---|
| 14日 | 0.0 | 0.0% | 100% | ✅ 推奨（最短 = 悪用リスク最小） |
| 30日 | 0.0 | 0.0% | 90.3% | △ 安定性がやや低下 |
| 60日 | 0.0 | 0.0% | 96.6% | △ 不必要に長い |

**結論：Grace Period = 14日**

全期間で FPR=0、ROI=0（攻撃者なし）で差が出なかったため、
悪用リスクを最小化する **14日** を推奨。

---

## 4. T010 距離軸比較（3層 vs 4層）

**Scenario G：N=1000、k=[1,5,10,20,50]**

| k | 3層 ROI | 4層 ROI | 改善率 | 評価 |
|---|---|---|---|---|
| 1 | 0.0045 | 0.3510 | **-7704%（悪化）** | 3層の圧勝 |
| 5 | 0.2632 | 0.2677 | -1.7%（同等） | ほぼ差なし |
| 10 | 0.5704 | 0.6647 | -16.5%（悪化） | 3層が優位 |
| 20 | 1.3758 | 0.9597 | **+30.2%（改善）** | 4層が有効 |
| 50 | 0.6810 | 0.8441 | -24.0%（悪化） | 3層が優位 |

**結論：Phase 0 は 3層で十分**

距離軸（D軸）はWatts-Strogatz小世界ネットワークでは一貫した効果を示さなかった。
実際の地理情報・GPS データがあれば再評価を推奨。Phase 0 は D=0.5 固定でよい。

---

## 5. 残存課題と設計上の限界

### 5.1 Scenario A (Simple Sybil) の根本的限界

| 問題 | 現状 | 原因 |
|---|---|---|
| TPR が低い（0〜30%） | 攻撃者が正直者と同じ行動 | スコアリングでの区別が原理的に困難 |
| ROI が 0.5〜0.8 | 目標 < 0.1 | デバイス紐づけ（D軸の本実装）がなければ達成不可 |

**解決策：** D軸に「デバイス/SIM 一意性証明」を組み込むことで、
1人1デバイス制約 → 複数巣の維持コストが急増 → ROI が構造的に低下

### 5.2 Scenario C (Loop Attack) の ROI

| 現状 | DoE 後 |
|---|---|
| ROI = 69.7（Stage 2 デフォルト） | ROI = 66〜73（DoE 全 16 実験で高止まり） |

**原因：** ループ攻撃者が高頻度取引 → T(v)の Bell-Curve で一部ペナルティを受けるが、
E(v) の partner-diversity 検出だけでは ROI を目標値まで下げられない。

**追加対策案：**
- 取引量に上限（daily cap）を設ける
- ループ検出専用フラグ（同一ペア取引の閾値監視）

### 5.3 Gini 係数（分配不平等）

全テストで Gini = 0.5〜0.7（目標 0.2〜0.3）。
Bloom イベントの集中配分と初期残高の分散が主因。
**改善案：** Bloom 受賞者を複数（3〜5巣）に分散、または1回配分量を削減。

---

## 6. Phase 0 サクセスチェックリスト 最終状況

| 項目 | 状態 | 備考 |
|---|---|---|
| Sybil ROI(100) < 1/150 | ❌ 未達 | T004(N=100K) 未実行。D軸なしでは達成困難 |
| False Positive 率 < 1% | △ 部分達成 | Scenario D/E/F は達成。Scenario A は FPR=28% |
| κ, θ の最適値を決定 | ✅ **決定** | κ=0.5, θ=0.35 |
| Bloom 間隔・配分量を決定 | ✅ **決定** | Bloom=7日, 75/25 比率を維持 |
| Grace Period 期間を決定 | ✅ **決定** | 14日 |
| コミュニティ検出アルゴリズムを選定 | ✅ Louvain 採用 | 安定性 90〜100% |
| 距離軸の要否を結論付ける | ✅ **結論** | Phase 0 では不使用（3層で進める） |
| ZK-SNARK 証明コスト確認 | ❌ 未実施 | シミュレーション外の検証が必要 |
| 全テストでサクセス条件 | ❌ 一部未達 | D軸実装後に再検証 |

---

## 7. Phase 1 への提言

1. **D軸（デバイス紐づけ）の本実装が最優先**
   ZK-SNARK または類似の証明機構で「1巣1デバイス」を強制すれば、
   Scenario A の ROI < 0.1 達成が現実的になる。

2. **ループ攻撃対策の追加**
   E(v) の改善に加えて、日次取引上限（cap）の導入を検討。

3. **Gini 改善**
   Bloom の受賞分散（1巣 → 3〜5巣）または配分率の再調整。

4. **T004 (N=100K) の実行**
   大規模検証は高スペックマシンまたはクラウド実行を推奨（推定時間 4〜6 時間）。

---

## 8. 実装済みモジュール一覧（Stage 1〜3 完了）

| ファイル | 内容 | 状態 |
|---|---|---|
| `simulation/src/config.py` | パラメータ定義・T001〜T010 | ✅ |
| `simulation/src/network_generator.py` | Watts-Strogatz + SimulationState | ✅ |
| `simulation/src/transaction_engine.py` | Poisson取引・攻撃者戦略 | ✅ |
| `simulation/src/scoring.py` | 3軸 T/E/D・softmin・Bell-Curve（Stage 3強化）| ✅ |
| `simulation/src/mana_distributor.py` | 75/25 Mana + VRF Bloom | ✅ |
| `simulation/src/community_detector.py` | Louvain・α(c)正規化 | ✅ |
| `simulation/src/metrics.py` | 全評価指標 | ✅ |
| `simulation/src/runner.py` | 180日ループ・全シナリオ | ✅ |
| `simulation/src/doe_optimizer.py` | L16 DoE 最適化 | ✅ |
| `simulation/scenario_t010.py` | T010 距離軸比較 | ✅ |
| `simulation/notebooks/01_basic_simulation.ipynb` | Stage 1 MVP | ✅ |
| `simulation/notebooks/02_scenario_testing.ipynb` | Stage 2 全シナリオ | ✅ |
| `simulation/notebooks/03_parameter_optimization.ipynb` | Stage 3 DoE分析 | ✅ |
